{"data":{"site":{"siteMetadata":{"title":"stackcheats"}},"markdownRemark":{"id":"a1ca2428-16c1-5ab2-8627-563a54537337","excerpt":"A Story Guide Stackcheats is a cheat-blog platform where developers and technical writers can create & write tech-cheats by owning user accounts. More…","html":"<h2>A Story Guide</h2>\n<p>Stackcheats is a cheat-blog platform where developers and technical writers can create &#x26; write tech-cheats by owning user accounts. More importantly, Stackcheats has been using the WSO2 Identity Server as its identity and access management tool to manage user registrations and management tasks.</p>\n<p>A tech-developer named “Athiththan” have been requested to develop a custom component to validate the password against a list of defective passwords when users trying to update (renew).</p>\n<h2>Development</h2>\n<p class=\"quote text-secondary\">\n    WSO2 Identity Server (5.3.0 ≤ onwards) now supports to handle published events using an integrated event framework by extending `AbstractEventHandler`\n</p>\n<p>So, Athiththan chose to develop the custom component as an event-handler listening to different password-update events to trigger and to validate the given password.\nWe can use the following custom maven archetype to generate boilerplate to extend and implement custom event-handlers for WSO2 Identity Server.</p>\n<h3>Handle Event</h3>\n<p>The AbstractEventHandler contains a method named handleEvent() which gets triggered whenever a pre-registered event is made upon the Identity Server. So, for this custom implementation, he will be using the following two publish events …</p>\n<ul>\n<li>\n<pre>PRE_UPDATE_CREDENTIAL</pre>\n</li>\n<li>\n<pre>PRE_UPDATE_CREDENTIAL_BY_ADMIN</pre>\n</li>\n</ul>\n<p><div id=\"gist97067820\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-defectivepasswordvalidatoreventhandler-java\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-java \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">@Override</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> handleEvent(<span class=\"pl-smi\">Event</span> event) throws <span class=\"pl-smi\">IdentityEventException</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (log<span class=\"pl-k\">.</span>isDebugEnabled()) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC5\" class=\"blob-code blob-code-inner js-file-line\">        log<span class=\"pl-k\">.</span>debug(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>handleEvent() invoked<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC6\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC7\" class=\"blob-code blob-code-inner js-file-line\">    </td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">IdentityEventConstants</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">Event</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>PRE_UPDATE_CREDENTIAL</span><span class=\"pl-k\">.</span>equals(event<span class=\"pl-k\">.</span>getEventName())</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC9\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">||</span> <span class=\"pl-smi\">IdentityEventConstants</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">Event</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>PRE_UPDATE_CREDENTIAL_BY_ADMIN</span><span class=\"pl-k\">.</span>equals(event<span class=\"pl-k\">.</span>getEventName())) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC11\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">Object</span> credential <span class=\"pl-k\">=</span> event<span class=\"pl-k\">.</span>getEventProperties()<span class=\"pl-k\">.</span>get(<span class=\"pl-smi\">IdentityEventConstants</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">EventProperty</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>CREDENTIAL</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">DefaultDefectivePasswordValidator</span><span class=\"pl-k\">.</span>getInstance()<span class=\"pl-k\">.</span>validate(credential)) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC13\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC14\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">if</span> (log<span class=\"pl-k\">.</span>isDebugEnabled()) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC15\" class=\"blob-code blob-code-inner js-file-line\">                log<span class=\"pl-k\">.</span>debug(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>given password is defective<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC16\" class=\"blob-code blob-code-inner js-file-line\">            }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC17\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC18\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">throw</span> <span class=\"pl-smi\">Utils</span><span class=\"pl-k\">.</span>handleEventException(</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC19\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=\"pl-smi\">DefectivePasswordValidatorConstants</span><span class=\"pl-k\">.</span><span class=\"pl-smi\">ErrorMessages</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>ERROR_CODE_CRACKED_PASSWORD_VALIDATION</span>, <span class=\"pl-c1\">null</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC20\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC21\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-defectivepasswordvalidatoreventhandler-java-LC22\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/2b8b5690bf65b7d16eb2973bbaa22442/raw/d6a5eff4da283d5eb0f008f363644be07057bd0c/DefectivePasswordValidatorEventHandler.java\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/2b8b5690bf65b7d16eb2973bbaa22442#file-defectivepasswordvalidatoreventhandler-java\">DefectivePasswordValidatorEventHandler.java</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h3>Password Validator</h3>\n<p>Given below is the implementation to validate the given password against a list of defective passwords. The given implementation reads all the defective passwords from a text file named passwords.txt which is placed inside the <code class=\"language-text\">/&lt;IS_HOME&gt;/deployments/server/defective</code> folder.</p>\n<blockquote>\n<p>For testing purposes, the given implementation can be modified to work with pre-defined list of defective passwords using ArrayList&#x3C;>.</p>\n</blockquote>\n<p><div id=\"gist97082108\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-defaultdefectivepasswordvalidator-java\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-java \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">DefaultDefectivePasswordValidator</span> <span class=\"pl-k\">implements</span> <span class=\"pl-e\">DefectivePasswordValidator</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC2\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC3\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">List&lt;<span class=\"pl-smi\">String</span>&gt;</span> crackedPasswords <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ArrayList&lt;&gt;</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">DefaultDefectivePasswordValidator</span> dPasswordValidator <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-smi\">DefaultDefectivePasswordValidator</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC5\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC6\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">final</span> <span class=\"pl-smi\">Logger</span> log <span class=\"pl-k\">=</span> <span class=\"pl-smi\">LoggerFactory</span><span class=\"pl-k\">.</span>getLogger(<span class=\"pl-smi\">DefaultDefectivePasswordValidator</span><span class=\"pl-k\">.</span>class);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">private</span> <span class=\"pl-en\">DefaultDefectivePasswordValidator</span>() {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC9\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC10\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC11\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">DefaultDefectivePasswordValidator</span> <span class=\"pl-en\">getInstance</span>() {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> dPasswordValidator;</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC13\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC14\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">/**</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">     * initialize defective password values from the given text file</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">     <span class=\"pl-c\">*/</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC18\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">@Override</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC19\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">initValues</span>() {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC20\" class=\"blob-code blob-code-inner js-file-line\">        crackedPasswords <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-k\">ArrayList&lt;&gt;</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC21\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">try</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC22\" class=\"blob-code blob-code-inner js-file-line\">            crackedPasswords <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Files</span><span class=\"pl-k\">.</span>readAllLines(<span class=\"pl-smi\">Paths</span><span class=\"pl-k\">.</span>get(<span class=\"pl-smi\">DefectivePasswordValidatorConstants</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>PASSWORD_FILE_PATH</span>),</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC23\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=\"pl-smi\">StandardCharsets</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>UTF_8</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC24\" class=\"blob-code blob-code-inner js-file-line\">        } <span class=\"pl-k\">catch</span> (<span class=\"pl-smi\">IOException</span> e) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC25\" class=\"blob-code blob-code-inner js-file-line\">            log<span class=\"pl-k\">.</span>error(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Exception occured while reading and initializing values from <span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC26\" class=\"blob-code blob-code-inner js-file-line\">                    <span class=\"pl-k\">+</span> <span class=\"pl-smi\">DefectivePasswordValidatorConstants</span><span class=\"pl-c1\"><span class=\"pl-k\">.</span>PASSWORD_FILE_NAME</span>, e);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC27\" class=\"blob-code blob-code-inner js-file-line\">        }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC28\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC29\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC30\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">/**</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC31\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">     * validate method</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC32\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">     <span class=\"pl-c\">*/</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC33\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">@Override</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC34\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">public</span> <span class=\"pl-k\">boolean</span> <span class=\"pl-en\">validate</span>(<span class=\"pl-smi\">Object</span> <span class=\"pl-v\">credential</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC35\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">return</span> <span class=\"pl-k\">!</span>crackedPasswords<span class=\"pl-k\">.</span>contains((<span class=\"pl-smi\">String</span>) credential);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC36\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-defaultdefectivepasswordvalidator-java-LC37\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/91f041fb6285235d2708580e914ce13c/raw/8c1e4b9f69e2eb0454002e789f96dde4f8032fde/DefaultDefectivePasswordValidator.java\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/91f041fb6285235d2708580e914ce13c#file-defaultdefectivepasswordvalidator-java\">DefaultDefectivePasswordValidator.java</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h3>OSGi Component</h3>\n<p>The custom event-handler has to be registered as a service component (OSGi) with the Identity Server components to work flawlessly. In order to register the custom implementation as a service component, he wrote a ServiceComponent class containing both activate and deactivate methods to register it with the Bundle Context.</p>\n<p><div id=\"gist97068467\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-defectivepasswordvalidatorservicecomponent-java\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-java \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">@Activate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">protected</span> <span class=\"pl-k\">void</span> activate(<span class=\"pl-smi\">ComponentContext</span> context) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">try</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC5\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC6\" class=\"blob-code blob-code-inner js-file-line\">        context<span class=\"pl-k\">.</span>getBundleContext()<span class=\"pl-k\">.</span>registerService(<span class=\"pl-smi\">AbstractEventHandler</span><span class=\"pl-k\">.</span>class<span class=\"pl-k\">.</span>getName(),</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC7\" class=\"blob-code blob-code-inner js-file-line\">                <span class=\"pl-k\">new</span> <span class=\"pl-smi\">DefectivePasswordValidatorEventHandler</span>(), <span class=\"pl-c1\">null</span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC9\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> initialize all defective passwords from the text file</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC10\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">DefaultDefectivePasswordValidator</span><span class=\"pl-k\">.</span>getInstance()<span class=\"pl-k\">.</span>initValues();</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC12\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c\"><span class=\"pl-c\">//</span> initialize watchservice on /defective directory</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC13\" class=\"blob-code blob-code-inner js-file-line\">        initializeWatchService();</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC14\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC15\" class=\"blob-code blob-code-inner js-file-line\">    } <span class=\"pl-k\">catch</span> (<span class=\"pl-smi\">Throwable</span> e) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC16\" class=\"blob-code blob-code-inner js-file-line\">        log<span class=\"pl-k\">.</span>error(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Error occured while initializing service component<span class=\"pl-pds\">&quot;</span></span>, e);</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC17\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC19\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">@Deactivate</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-defectivepasswordvalidatorservicecomponent-java-LC21\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">protected</span> <span class=\"pl-k\">void</span> deactivate(<span class=\"pl-smi\">ComponentContext</span> context) { }</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/b1156885c454c5613fbb953c21fb7ca4/raw/939883d0968b52d80aff4e0b686f6f2d8793dbb4/DefectivePasswordValidatorServiceComponent.java\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/b1156885c454c5613fbb953c21fb7ca4#file-defectivepasswordvalidatorservicecomponent-java\">DefectivePasswordValidatorServiceComponent.java</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Prepare</h2>\n<h3>Defective Passwords Text File</h3>\n<p>Create a file called passwords.txt and add all defective-passwords (cracked passwords) at each line. These defined cracked passwords are the values, will be used to validate the entered password.</p>\n<p>Create a folder named defective inside the &#x3C;IS_HOME>/repository/deployment/server directory and place the above created passwords.txt file in it.</p>\n<h3>WSO2 Identity Server</h3>\n<p>Navigate to &#x3C;IS_HOME>/repository/conf/identity directory and open the identity-event.properties file and add the following lines at the bottom to subscribe to the published events.</p>\n<blockquote>\n<p>Please update the digit value according to your <code class=\"language-text\">identity-event.properties</code> file (last used value + 1)</p>\n<p>The given <code class=\"language-text\">module.name</code> value is the same value which configured in the <code class=\"language-text\">getName()</code> method in <code class=\"language-text\">DefectivePasswordValidatorEventHandler</code> class</p>\n</blockquote>\n<p><div id=\"gist97082148\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-identity-event-properties\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-ini \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-identity-event-properties-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-identity-event-properties-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">module.name.13</span>=defectivePasswordValidator</td>\n      </tr>\n      <tr>\n        <td id=\"file-identity-event-properties-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-identity-event-properties-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">defectivePasswordValidator.subscription.1</span>=PRE_UPDATE_CREDENTIAL</td>\n      </tr>\n      <tr>\n        <td id=\"file-identity-event-properties-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-identity-event-properties-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">defectivePasswordValidator.subscription.2</span>=PRE_UPDATE_CREDENTIAL_BY_ADMIN</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/fc5bc7e1b8e46124ed0fa993a4324580/raw/841ceca5796578427010849a8f37bf01ce3c6475/identity-event.properties\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/fc5bc7e1b8e46124ed0fa993a4324580#file-identity-event-properties\">identity-event.properties</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Build, Run &#x26; Test</h2>\n<h3>Build</h3>\n<p>You can clone or download the custom event-handler implementation project done by Athiththan from GitHub and build it using the following command …</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mvn clean package</code></pre></div>\n<h3>Run</h3>\n<p>After a successful build, copy the <code class=\"language-text\">defective-password-validator-1.0.0.jar</code> artifact and place it inside the <code class=\"language-text\">&lt;IS_HOME&gt;/repository/components/dropins</code> folder.</p>\n<p>Start your WSO2 Identity Server by navigating to the <code class=\"language-text\">&lt;IS_HOME&gt;/bin</code> folder and executing the following command …</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">sh wso2server.sh</code></pre></div>\n<h3>Test</h3>\n<p>After server startup, navigate to <code class=\"language-text\">https://&lt;IP_ADDRESS&gt;:9443/dashboard</code> and log in using <code class=\"language-text\">admin</code> as both username and password. Click on the <em>“View Details”</em> button on the <em>“Change Password”</em> section and type your current password and enter the new password as one of the defective passwords and try on.</p>\n<h2>GitHub</h2>\n<br>\n<a class=\"ul-disabled\" href=\"https://github.com/athiththan11/Defective-Password-Validator\">\n    <div class=\"card\">\n        <div class=\"card-horizontal\">\n            <div class=\"card-body py-4 px-5\">\n                <h4 class=\"card-title mt-4\">Defective Password Validator</h4>\n                <p>Defective password validation using WSO2 Event Handlers extension</p>\n                <footer class=\"blockquote-footer\">\n                    <small class=\"text-muted\">\n                        athiththan11\n                    </small>\n                </footer>\n            </div>\n            <div class=\"img-square-wrapper\">\n                <img class=\"rounded mb-0\" width=\"220.172\" src=\"https://avatars3.githubusercontent.com/u/29927177?s=460&amp;v=4\" alt>\n            </div>\n        </div>\n    </div>\n</a>\n<hr class=\"three--dots\"/>","frontmatter":{"title":"Custom Event Handlers for Password Validation","intro":"WSO2 Identity Server: Event Handlers + Java WatchService","tags":["wso2","wso2-identity-server","event-handlers"],"author":"Athiththan"}}},"pageContext":{"slug":"/Custom-Event-Handlers-for-Password-Validation/","node_id":"a1ca2428-16c1-5ab2-8627-563a54537337","nodePath":"/Custom-Event-Handlers-for-Password-Validation/","nodeType":"sheet","title":"Custom Event Handlers for Password Validation","category":"WSO2","weight":-1,"updated":"2019-06-15T00:00:00.000Z","author":"Athiththan","short":"A Custom Event Handler Implementation","tags":["wso2","wso2-identity-server","event-handlers"]}}