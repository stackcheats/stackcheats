{"data":{"site":{"siteMetadata":{"title":"stackcheats"}},"markdownRemark":{"id":"1d7c131a-7f64-556a-a7dc-71d266b94b49","excerpt":"This post illustrates how to add an LDAP user-store as a secondary user-store in WSO2 API Manager (in almost every WSO2 Product). For demo purposes, we will be…","html":"<p>This post illustrates how to add an LDAP user-store as a secondary user-store in WSO2 API Manager (in almost every WSO2 Product).</p>\n<blockquote>\n<p>For demo purposes, we will be using a pre-configured LDAP user-store which resides in <strong>WSO2 Identity Server</strong> and shipped by default</p>\n</blockquote>\n<h2>Configure</h2>\n<p>Download both <a href=\"https://wso2.com/api-management/\">WSO2 API Manager (2.6.0)</a> and <a href=\"https://wso2.com/identity-and-access-management/\">WSO2 Identity Server (5.7.0)</a> as binary artifacts from the official download page and follow the given steps to configure port offset on them.</p>\n<h3>WSO2 Identity Server</h3>\n<p>Extract the binary artifact of WSO2 Identity Server and navigate to <code class=\"language-text\">[IS]/bin</code> folder and execute the following command based on your environment to start the server …</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># linux env\n./wso2server.sh\n\n# windows env\n./wso2server.bat</code></pre></div>\n<h3>WSO2 API Manager</h3>\n<p>Extract the binary artifact of WSO2 API Manager and navigate to [APIM]/repository/conf/carbon.xml to edit the port offset configurations of API Manager.</p>\n<blockquote>\n<p>We will be using the default shipped LDAP user-store of WSO2 Identity Server as the secondary user-store in API Manager. Therefore, we will be running both the server nodes in a single machine. For this reason, we will be port off-setting the API Manager node</p>\n</blockquote>\n<p>Open and edit the <code class=\"language-text\">&lt;Offset&gt;</code> element with the following …</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Offset</span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Offset</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Start the server by executing the following command based on your environment</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"># linux env\n./wso2server.sh\n\n# windows env\n./wso2server.bat</code></pre></div>\n<p>And login to the management console by directing to <a href=\"https://localhost:9444/carbon\"><code class=\"language-text\">https://localhost:9444/carbon</code></a> and enter <code class=\"language-text\">admin</code> as both the username and password. Next select <code class=\"language-text\">Add</code> under <code class=\"language-text\">User Stores</code> section in <code class=\"language-text\">Main</code> tab.</p>\n<p><img src=\"assets/configure-ldap-as-a-secondary-user-store/add-user-store-api-manager.png\" alt=\"Add User Store in WSO2 API Manager (2.6.0)\"></p>\n<p>Enter the inputs as follows …</p>\n<ul>\n<li>User Store Manager Class: select <code class=\"language-text\">ReadWriteLDAPUserStoreManager</code> or <code class=\"language-text\">ReadOnlyLDAPUserStoreManager</code> based on your preference</li>\n<li>Domain Name: give a related domain name to identify the users from this user-store. We will be using <code class=\"language-text\">IS</code> as the domain name</li>\n<li>Connection URL: <code class=\"language-text\">ldap://localhost:10389</code></li>\n<li>Connection Name: <code class=\"language-text\">uid=admin,ou=system</code></li>\n<li>Connection Password: <code class=\"language-text\">admin</code></li>\n<li>User Search Based: <code class=\"language-text\">ou=Users,dc=wso2,dc=org</code></li>\n<li>User Entry Object Class: <code class=\"language-text\">identityPerson</code></li>\n<li>Username Attribute: <code class=\"language-text\">uid</code></li>\n<li>User Search Filter: <code class=\"language-text\">(&amp;(objectClass=person)(uid=?))</code></li>\n<li>User List Filter: <code class=\"language-text\">(objectClass=person)</code></li>\n</ul>\n<blockquote>\n<p>Please enter relavant configuration values and properties if your LDAP configurations are different from the above-mentioned</p>\n</blockquote>\n<p><img src=\"assets/configure-ldap-as-a-secondary-user-store/user-store-configurations.png\" alt=\"User Store Configurations\"></p>\n<p>Click on <code class=\"language-text\">Add</code> to save and add the user-store in WSO2 API Manager. The following alert box will appear if the user-store is added correctly.</p>\n<p><img src=\"assets/configure-ldap-as-a-secondary-user-store/successful-alert-box.png\" alt=\"Successful Alert Box\"></p>\n<h2>Run &#x26; Test</h2>\n<p>Direct to <a href=\"https://localhost:9444/carbon\"><code class=\"language-text\">https://localhost:9444/carbon</code></a> and select <code class=\"language-text\">List</code> under <code class=\"language-text\">Users and Roles</code> section and select <code class=\"language-text\">Users</code> from the prompted page to list all available users from all defined user-stores.</p>\n<p>You will see a similar page as follows …</p>\n<p><img src=\"assets/configure-ldap-as-a-secondary-user-store/user-list-in-api-manager.png\" alt=\"Users List in WSO2 API Manager\"></p>\n<p>Select <code class=\"language-text\">View Roles</code> of <code class=\"language-text\">IS/admin</code> user and click on <code class=\"language-text\">Permissions</code> of <code class=\"language-text\">IS/admin</code> role in the next page. Thereafter, select theLogin permission in the listed permission tree.</p>\n<p><img src=\"assets/configure-ldap-as-a-secondary-user-store/permission-tree.png\" alt=\"Permission Tree of IS/admin Role\"></p>\n<p>And select Update to update the permission tree. Now, logout from the carbon console and again Sign-in using the following credentials …</p>\n<ul>\n<li>Username: <code class=\"language-text\">IS/admin</code></li>\n<li>Password: <code class=\"language-text\">admin</code></li>\n</ul>\n<blockquote>\n<p>The above-mentioned credentials are related to the admin user of the secondary user-store</p>\n</blockquote>\n<p>After a successful login, the management console will be displayed with allowed features set and panels (allowed permissions).</p>\n<hr class=\"three--dots\"/>","frontmatter":{"title":"Configure LDAP as a Secondary User Store","intro":"WSO2 API Manager & Identity Server: LDAP User Store","tags":["wso2","wso2-api-manager","wso2-identity-server","ldap"],"author":"Athiththan"}}},"pageContext":{"slug":"/Configure-LDAP-as-a-Secondary-User-Store/","node_id":"1d7c131a-7f64-556a-a7dc-71d266b94b49","nodePath":"/Configure-LDAP-as-a-Secondary-User-Store/","nodeType":"sheet","title":"Configure LDAP as a Secondary User Store","category":"WSO2","weight":-1,"updated":"2019-09-08T00:00:00.000Z","author":"Athiththan","short":"A Quick Guide Configuring a Secondary User Store","tags":["wso2","wso2-api-manager","wso2-identity-server","ldap"]}}