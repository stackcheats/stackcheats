{"data":{"site":{"siteMetadata":{"title":"stackcheats"}},"markdownRemark":{"id":"51f5b88a-da9c-588c-95f2-b619c85c5533","excerpt":"This post narrates on how-to enable and register a service provider for SAML SSO using WSO2 Identity Server and to develop a simple Express-based webâ€¦","html":"<p>This post narrates on how-to enable and register a service provider for SAML SSO using WSO2 Identity Server and to develop a simple Express-based web application with Passport-SAML component to support and authenticate the users via SAML SSO.</p>\n<blockquote>\n<p>Security Assertion Markup Language (SAML) is an XML-based framework for authentication and authorization between a Service Provider and an Identity Provider. SAML is a standard Single-Sign-On (SSO) format. Authentication information is exchanged through digitally signed XML documents.</p>\n<p><a href=\"https://auth0.com/blog/how-saml-authentication-works\">For more on SAML</a></p>\n</blockquote>\n<h2>Implementation</h2>\n<h3>Express Application</h3>\n<p>Create an express application by executing <code class=\"language-text\">npm init</code> command, and provide all necessary properties to start the development.</p>\n<p>Install all below-listed dependencies by either running <code class=\"language-text\">npm install &lt;module&gt; --save</code> command or by replacing the dependencies object with the values.</p>\n<p>A complete package.json is given below.</p>\n<p><div id=\"gist97088616\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-package-json\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-json \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-package-json-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-package-json-LC1\" class=\"blob-code blob-code-inner js-file-line\">{</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-package-json-LC2\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>name<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>expresssaml<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-package-json-LC3\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>version<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1.0.0<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-package-json-LC4\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>description<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Express Application with SAML SSO<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-package-json-LC5\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>main<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>server.js<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-package-json-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>scripts<span class=\"pl-pds\">&quot;</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-package-json-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>test<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>echo <span class=\"pl-cce\">\\&quot;</span>Error: no test specified<span class=\"pl-cce\">\\&quot;</span> &amp;&amp; exit 1<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-package-json-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t},</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-package-json-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>author<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>athiththan11<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-package-json-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>homepage<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>https://github.com/athiththan11/Passport-SAML-WSO2<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-package-json-LC11\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>keywords<span class=\"pl-pds\">&quot;</span></span>: [</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-package-json-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>wso2-saml-sso<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-package-json-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>passport-saml<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-package-json-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t],</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-package-json-LC15\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>license<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ISC<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-package-json-LC16\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>dependencies<span class=\"pl-pds\">&quot;</span></span>: {</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-package-json-LC17\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>body-parser<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1.19.0<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-package-json-LC18\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>dotenv<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>8.0.0<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-package-json-LC19\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ejs<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>2.6.2<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-package-json-LC20\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>express<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>4.17.1<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-package-json-LC21\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>express-session<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>1.16.2<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-package-json-LC22\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>passport<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>0.3.2<span class=\"pl-pds\">&quot;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-package-json-LC23\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>passport-saml<span class=\"pl-pds\">&quot;</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>0.15.0<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-package-json-LC24\" class=\"blob-code blob-code-inner js-file-line\">\t},</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-package-json-LC25\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>devDependencies<span class=\"pl-pds\">&quot;</span></span>: {}</td>\n      </tr>\n      <tr>\n        <td id=\"file-package-json-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-package-json-LC26\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/dc553a891a27c379515860249caed35c/raw/18721c1fe4498c15dbe19a6187d6a4c296fa46ec/package.json\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/dc553a891a27c379515860249caed35c#file-package-json\">package.json</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<p>Create a Javascript file named <code class=\"language-text\">server.js</code> in the root directory of our express application with the below-given code-segments.</p>\n<blockquote>\n<p><strong>Note: EJS template implementations are not covered here</strong></p>\n<p>Check out the complete implementation of our express application at the end of this blog followed by a <a href=\"https://github.com/athiththan11/Passport-SAML-WSO2\">GitHub</a> repo. The implementation contains simple EJS templates to render the pages and outputs.</p>\n</blockquote>\n<p><div id=\"gist97088674\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-server-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-server-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-server-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>dotenv<span class=\"pl-pds\">&#39;</span></span>).<span class=\"pl-en\">config</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-server-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> path <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>path<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-server-js-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> fs <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>fs<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-server-js-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-server-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> express <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>express<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-server-js-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> session <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>express-session<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-server-js-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> passport <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-server-js-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> saml <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport-saml<span class=\"pl-pds\">&#39;</span></span>).<span class=\"pl-smi\">Strategy</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-server-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-server-js-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> bodyParser <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>body-parser<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-server-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-server-js-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> userProfile;</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-server-js-LC13\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> app <span class=\"pl-k\">=</span> <span class=\"pl-en\">express</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-server-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-server-js-LC15\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">set</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>views<span class=\"pl-pds\">&#39;</span></span>, <span class=\"pl-smi\">path</span>.<span class=\"pl-c1\">join</span>(<span class=\"pl-c1\">__dirname</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>views<span class=\"pl-pds\">&#39;</span></span>));</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-server-js-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">set</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>view engine<span class=\"pl-pds\">&#39;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>ejs<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-server-js-LC17\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-server-js-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">use</span>(<span class=\"pl-smi\">express</span>.<span class=\"pl-en\">static</span>(<span class=\"pl-smi\">path</span>.<span class=\"pl-c1\">join</span>(<span class=\"pl-c1\">__dirname</span>, <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>public<span class=\"pl-pds\">&#39;</span></span>)));</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-server-js-LC19\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-server-js-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">use</span>(<span class=\"pl-smi\">bodyParser</span>.<span class=\"pl-en\">urlencoded</span>({ extended<span class=\"pl-k\">:</span> <span class=\"pl-c1\">true</span> }));</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-server-js-LC21\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">use</span>(<span class=\"pl-en\">session</span>({ secret<span class=\"pl-k\">:</span> <span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">SESSION_SECRET</span> }));</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-server-js-LC22\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-server-js-LC23\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">use</span>(<span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">initialize</span>());</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-server-js-LC24\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">use</span>(<span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">session</span>());</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-server-js-LC25\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-server-js-LC26\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">serializeUser</span>((<span class=\"pl-smi\">user</span>, <span class=\"pl-smi\">done</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-server-js-LC27\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">done</span>(<span class=\"pl-c1\">null</span>, user);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-server-js-LC28\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-server-js-LC29\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-server-js-LC30\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">deserializeUser</span>((<span class=\"pl-smi\">user</span>, <span class=\"pl-smi\">done</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-server-js-LC31\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">done</span>(<span class=\"pl-c1\">null</span>, user);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-server-js-LC32\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-server-js-LC33\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-server-js-LC34\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> saml strategy for passport</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-server-js-LC35\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> strategy <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-en\">saml</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-server-js-LC36\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-server-js-LC37\" class=\"blob-code blob-code-inner js-file-line\">\t\tentryPoint<span class=\"pl-k\">:</span> <span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">SAML_ENTRYPOINT</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-server-js-LC38\" class=\"blob-code blob-code-inner js-file-line\">\t\tissuer<span class=\"pl-k\">:</span> <span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">SAML_ISSUER</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-server-js-LC39\" class=\"blob-code blob-code-inner js-file-line\">\t\tprotocol<span class=\"pl-k\">:</span> <span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">SAML_PROTOCOL</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-server-js-LC40\" class=\"blob-code blob-code-inner js-file-line\">\t\tlogoutUrl<span class=\"pl-k\">:</span> <span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">SAML_LOGOUTURL</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-server-js-LC41\" class=\"blob-code blob-code-inner js-file-line\">\t},</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-server-js-LC42\" class=\"blob-code blob-code-inner js-file-line\">\t(<span class=\"pl-smi\">profile</span>, <span class=\"pl-smi\">done</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-server-js-LC43\" class=\"blob-code blob-code-inner js-file-line\">\t\tuserProfile <span class=\"pl-k\">=</span> profile;</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-server-js-LC44\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-en\">done</span>(<span class=\"pl-c1\">null</span>, userProfile);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-server-js-LC45\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-server-js-LC46\" class=\"blob-code blob-code-inner js-file-line\">);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-server-js-LC47\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-server-js-LC48\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">use</span>(strategy);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-server-js-LC49\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-server-js-LC50\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> <span class=\"pl-en\">redirectToLogin</span> <span class=\"pl-k\">=</span> (<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>, <span class=\"pl-smi\">next</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-server-js-LC51\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">req</span>.<span class=\"pl-en\">isAuthenticated</span>() <span class=\"pl-k\">||</span> userProfile <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-server-js-LC52\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>.<span class=\"pl-en\">redirect</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/login<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-server-js-LC53\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-server-js-LC54\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-en\">next</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-server-js-LC55\" class=\"blob-code blob-code-inner js-file-line\">};</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-server-js-LC56\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-server-js-LC57\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">get</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app<span class=\"pl-pds\">&#39;</span></span>, redirectToLogin, (<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-server-js-LC58\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-smi\">res</span>.<span class=\"pl-en\">render</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>index<span class=\"pl-pds\">&#39;</span></span>, {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"></td>\n        <td id=\"file-server-js-LC59\" class=\"blob-code blob-code-inner js-file-line\">\t\ttitle<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>Express Web Application<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"></td>\n        <td id=\"file-server-js-LC60\" class=\"blob-code blob-code-inner js-file-line\">\t\theading<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>Logged-In to Express Web Application<span class=\"pl-pds\">&#39;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"></td>\n        <td id=\"file-server-js-LC61\" class=\"blob-code blob-code-inner js-file-line\">\t});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"></td>\n        <td id=\"file-server-js-LC62\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"></td>\n        <td id=\"file-server-js-LC63\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"></td>\n        <td id=\"file-server-js-LC64\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">get</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"></td>\n        <td id=\"file-server-js-LC65\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/login<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"></td>\n        <td id=\"file-server-js-LC66\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">authenticate</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>saml<span class=\"pl-pds\">&#39;</span></span>, {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"></td>\n        <td id=\"file-server-js-LC67\" class=\"blob-code blob-code-inner js-file-line\">\t\tsuccessRedirect<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"></td>\n        <td id=\"file-server-js-LC68\" class=\"blob-code blob-code-inner js-file-line\">\t\tfailureRedirect<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/login<span class=\"pl-pds\">&#39;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"></td>\n        <td id=\"file-server-js-LC69\" class=\"blob-code blob-code-inner js-file-line\">\t})</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"></td>\n        <td id=\"file-server-js-LC70\" class=\"blob-code blob-code-inner js-file-line\">);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"></td>\n        <td id=\"file-server-js-LC71\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"></td>\n        <td id=\"file-server-js-LC72\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">get</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/logout<span class=\"pl-pds\">&#39;</span></span>, (<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"></td>\n        <td id=\"file-server-js-LC73\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">if</span> (<span class=\"pl-smi\">req</span>.<span class=\"pl-smi\">user</span> <span class=\"pl-k\">==</span> <span class=\"pl-c1\">null</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"></td>\n        <td id=\"file-server-js-LC74\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>.<span class=\"pl-en\">redirect</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/home<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"></td>\n        <td id=\"file-server-js-LC75\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"></td>\n        <td id=\"file-server-js-LC76\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"></td>\n        <td id=\"file-server-js-LC77\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">strategy</span>.<span class=\"pl-en\">logout</span>(req, (<span class=\"pl-smi\">err</span>, <span class=\"pl-smi\">uri</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"></td>\n        <td id=\"file-server-js-LC78\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-smi\">req</span>.<span class=\"pl-en\">logout</span>();</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"></td>\n        <td id=\"file-server-js-LC79\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L80\" class=\"blob-num js-line-number\" data-line-number=\"80\"></td>\n        <td id=\"file-server-js-LC80\" class=\"blob-code blob-code-inner js-file-line\">\t\tuserProfile <span class=\"pl-k\">=</span> <span class=\"pl-c1\">null</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L81\" class=\"blob-num js-line-number\" data-line-number=\"81\"></td>\n        <td id=\"file-server-js-LC81\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>.<span class=\"pl-en\">redirect</span>(uri);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L82\" class=\"blob-num js-line-number\" data-line-number=\"82\"></td>\n        <td id=\"file-server-js-LC82\" class=\"blob-code blob-code-inner js-file-line\">\t});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L83\" class=\"blob-num js-line-number\" data-line-number=\"83\"></td>\n        <td id=\"file-server-js-LC83\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L84\" class=\"blob-num js-line-number\" data-line-number=\"84\"></td>\n        <td id=\"file-server-js-LC84\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L85\" class=\"blob-num js-line-number\" data-line-number=\"85\"></td>\n        <td id=\"file-server-js-LC85\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-c1\">get</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/failed<span class=\"pl-pds\">&#39;</span></span>, (<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L86\" class=\"blob-num js-line-number\" data-line-number=\"86\"></td>\n        <td id=\"file-server-js-LC86\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-smi\">res</span>.<span class=\"pl-c1\">status</span>(<span class=\"pl-c1\">401</span>).<span class=\"pl-c1\">send</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>Login failed<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L87\" class=\"blob-num js-line-number\" data-line-number=\"87\"></td>\n        <td id=\"file-server-js-LC87\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L88\" class=\"blob-num js-line-number\" data-line-number=\"88\"></td>\n        <td id=\"file-server-js-LC88\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L89\" class=\"blob-num js-line-number\" data-line-number=\"89\"></td>\n        <td id=\"file-server-js-LC89\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">post</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L90\" class=\"blob-num js-line-number\" data-line-number=\"90\"></td>\n        <td id=\"file-server-js-LC90\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/saml/consume<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L91\" class=\"blob-num js-line-number\" data-line-number=\"91\"></td>\n        <td id=\"file-server-js-LC91\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">authenticate</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>saml<span class=\"pl-pds\">&#39;</span></span>, {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L92\" class=\"blob-num js-line-number\" data-line-number=\"92\"></td>\n        <td id=\"file-server-js-LC92\" class=\"blob-code blob-code-inner js-file-line\">\t\tfailureRedirect<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/failed<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L93\" class=\"blob-num js-line-number\" data-line-number=\"93\"></td>\n        <td id=\"file-server-js-LC93\" class=\"blob-code blob-code-inner js-file-line\">\t\tfailureFlash<span class=\"pl-k\">:</span> <span class=\"pl-c1\">true</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L94\" class=\"blob-num js-line-number\" data-line-number=\"94\"></td>\n        <td id=\"file-server-js-LC94\" class=\"blob-code blob-code-inner js-file-line\">\t}),</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L95\" class=\"blob-num js-line-number\" data-line-number=\"95\"></td>\n        <td id=\"file-server-js-LC95\" class=\"blob-code blob-code-inner js-file-line\">\t(<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L96\" class=\"blob-num js-line-number\" data-line-number=\"96\"></td>\n        <td id=\"file-server-js-LC96\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L97\" class=\"blob-num js-line-number\" data-line-number=\"97\"></td>\n        <td id=\"file-server-js-LC97\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> saml assertion extraction from saml response</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L98\" class=\"blob-num js-line-number\" data-line-number=\"98\"></td>\n        <td id=\"file-server-js-LC98\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> var samlResponse = res.req.body.SAMLResponse;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L99\" class=\"blob-num js-line-number\" data-line-number=\"99\"></td>\n        <td id=\"file-server-js-LC99\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> var decoded = base64decode(samlResponse);</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L100\" class=\"blob-num js-line-number\" data-line-number=\"100\"></td>\n        <td id=\"file-server-js-LC100\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> var assertion =</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L101\" class=\"blob-num js-line-number\" data-line-number=\"101\"></td>\n        <td id=\"file-server-js-LC101\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> \t(&#39;&lt;saml2:Assertion&#39; + decoded.split(&#39;&lt;saml2:Assertion&#39;)[1]).split(</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L102\" class=\"blob-num js-line-number\" data-line-number=\"102\"></td>\n        <td id=\"file-server-js-LC102\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> \t\t&#39;&lt;/saml2:Assertion&gt;&#39;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L103\" class=\"blob-num js-line-number\" data-line-number=\"103\"></td>\n        <td id=\"file-server-js-LC103\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> \t)[0] + &#39;&lt;/saml2:Assertion&gt;&#39;;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L104\" class=\"blob-num js-line-number\" data-line-number=\"104\"></td>\n        <td id=\"file-server-js-LC104\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> var urlEncoded = base64url(assertion);</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L105\" class=\"blob-num js-line-number\" data-line-number=\"105\"></td>\n        <td id=\"file-server-js-LC105\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L106\" class=\"blob-num js-line-number\" data-line-number=\"106\"></td>\n        <td id=\"file-server-js-LC106\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> success redirection to /app</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L107\" class=\"blob-num js-line-number\" data-line-number=\"107\"></td>\n        <td id=\"file-server-js-LC107\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-k\">return</span> <span class=\"pl-smi\">res</span>.<span class=\"pl-en\">redirect</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L108\" class=\"blob-num js-line-number\" data-line-number=\"108\"></td>\n        <td id=\"file-server-js-LC108\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L109\" class=\"blob-num js-line-number\" data-line-number=\"109\"></td>\n        <td id=\"file-server-js-LC109\" class=\"blob-code blob-code-inner js-file-line\">);</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L110\" class=\"blob-num js-line-number\" data-line-number=\"110\"></td>\n        <td id=\"file-server-js-LC110\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L111\" class=\"blob-num js-line-number\" data-line-number=\"111\"></td>\n        <td id=\"file-server-js-LC111\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">post</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/app/home<span class=\"pl-pds\">&#39;</span></span>, (<span class=\"pl-smi\">req</span>, <span class=\"pl-smi\">res</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L112\" class=\"blob-num js-line-number\" data-line-number=\"112\"></td>\n        <td id=\"file-server-js-LC112\" class=\"blob-code blob-code-inner js-file-line\">\t<span class=\"pl-smi\">res</span>.<span class=\"pl-en\">render</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>home<span class=\"pl-pds\">&#39;</span></span>, {</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L113\" class=\"blob-num js-line-number\" data-line-number=\"113\"></td>\n        <td id=\"file-server-js-LC113\" class=\"blob-code blob-code-inner js-file-line\">\t\ttitle<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>Express Web Application<span class=\"pl-pds\">&#39;</span></span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L114\" class=\"blob-num js-line-number\" data-line-number=\"114\"></td>\n        <td id=\"file-server-js-LC114\" class=\"blob-code blob-code-inner js-file-line\">\t\theading<span class=\"pl-k\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>Express Web Application<span class=\"pl-pds\">&#39;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L115\" class=\"blob-num js-line-number\" data-line-number=\"115\"></td>\n        <td id=\"file-server-js-LC115\" class=\"blob-code blob-code-inner js-file-line\">\t});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L116\" class=\"blob-num js-line-number\" data-line-number=\"116\"></td>\n        <td id=\"file-server-js-LC116\" class=\"blob-code blob-code-inner js-file-line\">});</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L117\" class=\"blob-num js-line-number\" data-line-number=\"117\"></td>\n        <td id=\"file-server-js-LC117\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-server-js-L118\" class=\"blob-num js-line-number\" data-line-number=\"118\"></td>\n        <td id=\"file-server-js-LC118\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">app</span>.<span class=\"pl-en\">listen</span>(<span class=\"pl-c1\">process</span>.<span class=\"pl-smi\">env</span>.<span class=\"pl-c1\">PORT</span> <span class=\"pl-k\">||</span> <span class=\"pl-c1\">3000</span>);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/9352d62cf837e5d05894a4a521d8bfd2/raw/42033d74658cfc3d52944d7c224c84202114af59/server.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/9352d62cf837e5d05894a4a521d8bfd2#file-server-js\">server.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h3>Passport</h3>\n<p><a href=\"http://www.passportjs.org\">Passport</a> is authentication middleware for Node.js and can be used with any Express-based web applications.</p>\n<blockquote>\n<p>Passport has a comprehensive set of strategies to support different authentication mechanisms with different vendors.</p>\n</blockquote>\n<p>For this implementation, we will be using <a href=\"http://www.passportjs.org/packages/passport-saml\">Passport-SAML</a> (which is an open-built strategy for SAML 2.0 authentication flows) strategy with our express web application to authenticate users.</p>\n<p>Given below is a simple <a href=\"http://www.passportjs.org/packages/passport-saml\">Passport-SAML</a> strategy configuration â€¦</p>\n<p><div id=\"gist97149709\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-strategy-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-strategy-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-strategy-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> passport <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-strategy-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> saml <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport-saml<span class=\"pl-pds\">&#39;</span></span>).<span class=\"pl-smi\">Strategy</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-strategy-js-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-strategy-js-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> saml strategy for passport</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-strategy-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> strategy <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-en\">saml</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-strategy-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-strategy-js-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t\tentryPoint<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide <span class=\"pl-c1\">SAML</span> entry point url <span class=\"pl-k\">:</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>localhost:9443/samlsso&gt;,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-strategy-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t\tissuer<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide <span class=\"pl-c1\">SAML</span> issuer name <span class=\"pl-k\">:</span> SampleExpressApp<span class=\"pl-k\">&gt;</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-strategy-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t\tprotocol<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide the protocol used <span class=\"pl-k\">:</span> http<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>&gt;,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-strategy-js-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t\tlogoutUrl<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide the logout url <span class=\"pl-k\">:</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>localhost:9443/samlsso&gt;</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-strategy-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">\t},</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-strategy-js-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t(<span class=\"pl-smi\">profile</span>, <span class=\"pl-smi\">done</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-strategy-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> your body implementation on success</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-strategy-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-strategy-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">);</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-strategy-js-LC16\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-strategy-js-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> register the strategy with passport</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-strategy-js-LC18\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">use</span>(strategy);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/9c1c2fa4a7948ae1b320cde8c089c7cb/raw/916522dae5eac1b147736ad3c8841d631176309d/strategy.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/9c1c2fa4a7948ae1b320cde8c089c7cb#file-strategy-js\">strategy.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Configurations</h2>\n<h3>WSO2 Identity Server</h3>\n<p>Create a new Service Provider in the WSO2 Identity Server to register our express application as one. Follow the given step by step guide to create new Service Provider and to register our express application enabling SAML SSO.</p>\n<p>Navigate to <em>Main (Tab) -> Identity (Section) -> Service Providers</em> (Sub-section) and select <em>Add</em>. The management console will display you the following screen to add a new service provider.</p>\n<p>Provide â€¦</p>\n<ul>\n<li>Service Provider Name: SampleExpressApp</li>\n<li>Description: Any valid description of the service provider</li>\n</ul>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 54.214285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9klEQVQoz6WS62qEMBCF8/4v2B8FqW7d3G/GaO7biVsK223B0o9hMNEZzjmI9hCl1OpACGGtba3dzoEW58ZxmucrpQwTwhiPMZ0slHJ7eZ0ul4lxbu0SYvTbdrIQaFzWTYJiLnLO7S+gEMI4vg3DQCk11mqt7dKxHWNMb/oXUK3VHK+hg4897Bjj+Yql0m71kMi6+nxQngDZLcZ4FwwBlpI5AxGMCyGVgq60/jFq+PpzGNbcr3JOjGBKKDmANfAERrz36RGY6sPgS0jpnKutlVpSTiFEiB2qk9K2w98QS63fqnsmGL/PM5iGRbXzEOnXqT6Bbv/gAxlnfe9jbFbcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Add New Service Provider\"\n        title=\"\"\n        src=\"/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-fb8a0.png\"\n        srcset=\"/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-1a291.png 148w,\n/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-2bc4a.png 295w,\n/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-fb8a0.png 590w,\n/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-526de.png 885w,\n/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-fa2eb.png 1180w,\n/static/add_new_service_provider_01-c3cae11c8052e11a17acf9489db63826-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>And click <em>Register</em> to register and create a new service provider. Afterward, the management console will display you the following screen to configure claim configuration, inbound authentication configurations and etc.</p>\n<p>Expand the <em>Claim Configurations (accordion)</em> to configure wanted claims and subject claim URI. We will be using the <em>Local Claim Dialect</em> as the <em>Claim mapping Dialect</em>.</p>\n<blockquote>\n<p>You can add all your wanted (requested claims) by clicking on the Add Claim URI button and selecting one from the drop-down menu</p>\n</blockquote>\n<p>For the demo, we will be selecting the following claims</p>\n<ul>\n<li><a href=\"http://wso2.org/claims/emailaddress\">http://wso2.org/claims/emailaddress</a></li>\n<li><a href=\"http://wso2.org/claims/username\">http://wso2.org/claims/username</a></li>\n<li><a href=\"http://wso2.org/claims/role\">http://wso2.org/claims/role</a></li>\n</ul>\n<p>And choose <code class=\"language-text\">http://wso2.org/claims/emailaddress</code> as the <em>Subject Claim URI</em>.</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.35714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABJklEQVQoz41Si46DIBDk/39Rq409Hy0WXUEQ0PMGaL0m1yY32egIy+7MIiOiqqpoHKdpEsNANCGARCKX8zssy8K2bVvXdd93oqGqLpz3CGOMcz6F92H3LRg2tdYo4b1DPaUUnlhZX7B9AEOB74iUBLL/AymfxZ4e30Yrzm9DsE1SSmstXMXHL2wECE4F2bB3vV6FEBCrIqL4Ob4f5Bnq4PCFXeacw0BRgtR8H0asJhdhkN5/couEcBjSMSpoGGg8X74451CODYG7kyrojmGdk5JwaSDPT8mOCclpKk6noijuQkCTIANfr60WLZU2SdSjM9xjQqiFSm3bonPf99ZZrQ0WU2rKPkjqB4MMZ+q6xrGu6/CrnSPQP8uyPM/By7Jsmqb7A7T5AccwenTKxCsCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Claim configurations\"\n        title=\"\"\n        src=\"/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-fb8a0.png\"\n        srcset=\"/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-1a291.png 148w,\n/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-2bc4a.png 295w,\n/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-fb8a0.png 590w,\n/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-526de.png 885w,\n/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-fa2eb.png 1180w,\n/static/claim_configurations-0c50dd7a5158057726e68c22f8d1e7a0-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Next, expand the <em>Inbound Authentication Configuration (accordion)</em> and click on <em>SAML2 Web SSO Configuration</em> and select <em>Configure</em> to configure SAML web SSO for our implemented express application.</p>\n<p>Configure the SAML SSO as follows â€¦</p>\n<ul>\n<li>Issuer: SampleExpressApp</li>\n<li>Assertion Consumer URLs: <a href=\"http://localhost:3000/saml/consume\">http://localhost:3000/saml/consume</a></li>\n<li>Enable Response Signing: True</li>\n<li>Enable Signature Validation in Authentication Requests and Logout Requests: False</li>\n</ul>\n<blockquote>\n<p>To enable signature validate in both authentication requests and logout requests, please refer the <code class=\"language-text\">Certificates and Signing</code> section.</p>\n</blockquote>\n<ul>\n<li>Enable Single Logout: True</li>\n<li>SLO Response URL: <a href=\"http://localhost:3000/app/home\">http://localhost:3000/app/home</a></li>\n<li>SLO Request URL: <a href=\"http://localhost:3000/app/home\">http://localhost:3000/app/home</a></li>\n<li>Enable Attribute Profile: True</li>\n<li>Include Attributes in the Response Always: True</li>\n</ul>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.21428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABB0lEQVQoz42R646EIAyFff93dBIFxiuICKLc3KPO/NmsuidNJJWvPaWZ1loppbWZpsn7EEL8f2RCKkKZEAL88lvrTUAZPu93BdhD4WgdUfWjM3kVGWy3bWuMWZ1DOS5kxwel53Ey9qi/XMTeGeX3G9ai4bZt1tpxVJjf2sW7xXm3XSillM3zXNc1OsMgUn3fk7IkhHAucOGseAczxsDAAlJN0+R5/nq9iqLARA/wPifnfdd5tzvEy1FK2SGct2vtMEYrCYVPbBsuzhWdLvD7AfYhYsPAIq6mNAySVU3XD9rYZzjEhBdGtzM1DJwQWtU1PN8M/IFXn4TUo5Tg7bGw9FX86k8LSP4AXVC757Bm6ewAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"SAML SSO configurations\"\n        title=\"\"\n        src=\"/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-fb8a0.png\"\n        srcset=\"/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-1a291.png 148w,\n/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-2bc4a.png 295w,\n/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-fb8a0.png 590w,\n/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-526de.png 885w,\n/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-fa2eb.png 1180w,\n/static/saml_sso_configurations-7c7bc03080f8a2312a77f25dcb526624-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>And select <em>Register</em> to register your SAML SSO configurations and the management console will prompt you to the previous configuration screen. Leave other configurations as it is and click on <em>Update</em>.</p>\n<blockquote>\n<p>Expand Local &#x26; Outbound Authentication Configuration and select Default as the Authentication Type and enable Use user store domain in roles configuration.</p>\n</blockquote>\n<h3>Express Application</h3>\n<p>After implementing the express application, create a <code class=\"language-text\">.env</code> file in the root path and enter the following properties.</p>\n<blockquote>\n<p>Change the <code class=\"language-text\">SAML_ENTRYPOINT</code> and <code class=\"language-text\">SAML_LOGOUTURL</code> properties if the IP-address and ports are different from default configurations</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"env\"><pre class=\"language-env\"><code class=\"language-env\">SESSION_SECRET=&quot;a well secured secret&quot;\n\nSAML_ENTRYPOINT=&quot;https://localhost:9443/samlsso&quot;\nSAML_ISSUER=&quot;SampleExpressApp&quot;\nSAML_PROTOCOL=&quot;http://&quot;\nSAML_LOGOUTURL=&quot;https://localhost:9443/samlsso&quot;\n\nWSO2_ROLE_CLAIM=&quot;http://wso2.org/claims/role&quot;\nWSO2_EMAIL_CLAIM=&quot;http://wso2.org/claims/emailaddress&quot;</code></pre></div>\n<h2>Certificates and Signing</h2>\n<p>To validate both authentication request and logout requests, we need to add relevant application certificates and private keys in both Identity Server and in our express application.</p>\n<blockquote>\n<p>For this demo, we will be using the default wso2carbon key-store to generate application certificates and private keys. The wso2carbon key-store can be found inside &#x3C;IS_HOME>/repository/resources/security directory</p>\n</blockquote>\n<p>To export the certificate from the key-store, execute the following command from the <code class=\"language-text\">security</code> folder</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">keytool -export -keystore wso2carbon.jks -alias wso2carbon -file wso2carbon.crt</code></pre></div>\n<p>The above-generated certificate will be in binary format. Use the following command to convert the above binary encoded certificate to PEM encoded certificate</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">openssl x509 -inform der -in wso2carbon.crt -out wso2carbon.pem</code></pre></div>\n<blockquote>\n<p>Copy the generated <code class=\"language-text\">wso2carbon.pem</code> file to another easily accessible folder</p>\n</blockquote>\n<h3>Configure: WSO2 Identity Server</h3>\n<p>Open the Identity Server and navigate to <em>Main (Tab) -> Identity (Section) -> Service Providers (Sub-section)</em> -> select <em>List</em> and <em>Edit (our service provider)</em>.</p>\n<p>In the Basic Information panel, select the <code class=\"language-text\">Choose File</code> button which is associated with the <em>Application Certificate</em> field. Choose the above-created <code class=\"language-text\">wso2carbon.pem</code> file and open.</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 45.07142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABA0lEQVQoz42Q63KCMBCF8/5PxS8ExvYBsEyRi3KJISEo1wRPUqudVmf6TRayG3ZPOKTrOtbwYRgWpcx6xvwMfEw450mSCCG44JSeOF5C2PS2adu2+4OUEnpEKSO3rquUbVlVjWWaZ6U1ZhuFRa0vINM09X2vtRa8iaIoy7KiKMqyZIxB8+va6gUEbYtVjuNPx3E8zwsCP0D4fhiGqOtvfsma5nvSMJrmh6KiFTWauM44jncRyP90C/eF5KO57y9wSHbnFnG+oBk/jynwBoESNnDTYnzECILjfbyvqxp1Sml9g54s9AEyZsM80QUBcjwWrrtxN9727T3cfeT54T8rTTO4egV1Ev7wMpG5rgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Application certificate configurations\"\n        title=\"\"\n        src=\"/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-fb8a0.png\"\n        srcset=\"/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-1a291.png 148w,\n/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-2bc4a.png 295w,\n/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-fb8a0.png 590w,\n/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-526de.png 885w,\n/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-fa2eb.png 1180w,\n/static/application_certificate_configurations-3bab67100dad78a7e78d1585892c6b0d-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Next, expand the <em>Inbound Authentication Configuration (accordion)</em> and click on <em>SAML2 Web SSO Configuration</em> and select Edit to update our SAML web SSO configurations. Enable signature validation in authentication requests and logout requests.</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 45.07142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA20lEQVQoz4VRXXODIBD0//++9qHThxiMtgIDFVQ+D7rRTJ6i2TlmgNtlb5bGWCuEWNc1hOBDsNYuyxJjdN7juF++rJRSk1NyG0optVZs5nne9TH4lHM9APgN2EopOOSNxznv+34YBujRJ6IzMXxY12mt6+Z8ZeyyAXoMXo+xO3s+cikEwbmUcfxt2/YKMGaMeSOelLl8fvTfX3b8WSR3SjrJya339vHMD3FMpJWerSXKqOlPC8GROcKsp7iLsZ5pAVLy7nbD5yGL9+IQSarJmAlP4HeeDTqdeef8A1ReDTzm6QslAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Enable signature validation\"\n        title=\"\"\n        src=\"/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-fb8a0.png\"\n        srcset=\"/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-1a291.png 148w,\n/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-2bc4a.png 295w,\n/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-fb8a0.png 590w,\n/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-526de.png 885w,\n/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-fa2eb.png 1180w,\n/static/enable_signature_validation-1b46f4ac6e490cc3a0843f6be12f37a0-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Click <em>Update</em> and <em>Update</em> again to update the service provider configurations.</p>\n<h3>Configure: Passport &#x26; Express App</h3>\n<p>Generate a private certificate for our express application. Execute the following commands to generate a private certificate from the default wso2carbon key-store.</p>\n<blockquote>\n<p>Use <code class=\"language-text\">wso2carbon</code> as the password for any password-prompts.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">keytool -importkeystore -srckeystore wso2carbon.jks -destkeystore wso2carbon.p12 -deststoretype PKCS12 -srcalias wso2carbon -deststorepass wso2carbon -destkeypass wso2carbon\n-------------\nopenssl pkcs12 -in wso2carbon.p12  -nodes -nocerts -out private-key.pem</code></pre></div>\n<p>Create folder named <code class=\"language-text\">security</code> in the root path of our express application and place both the generated <code class=\"language-text\">private-key.pem</code> and <code class=\"language-text\">wso2carbon.pem</code> inside.</p>\n<p>After placing the certificates, update the passport SAML strategy as follows</p>\n<p><div id=\"gist97210327\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-strategy-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-javascript \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-strategy-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-strategy-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> passport <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-strategy-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> saml <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>passport-saml<span class=\"pl-pds\">&#39;</span></span>).<span class=\"pl-smi\">Strategy</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-strategy-js-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-strategy-js-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> saml strategy for passport</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-strategy-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">var</span> strategy <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-en\">saml</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-strategy-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">\t{</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-strategy-js-LC7\" class=\"blob-code blob-code-inner js-file-line\">\t\tentryPoint<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide <span class=\"pl-c1\">SAML</span> entry point url <span class=\"pl-k\">:</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>localhost:9443/samlsso&gt;,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-strategy-js-LC8\" class=\"blob-code blob-code-inner js-file-line\">\t\tissuer<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide <span class=\"pl-c1\">SAML</span> issuer name <span class=\"pl-k\">:</span> SampleExpressApp<span class=\"pl-k\">&gt;</span>,</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-strategy-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">\t\tprotocol<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide the protocol used <span class=\"pl-k\">:</span> http<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>&gt;,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-strategy-js-LC10\" class=\"blob-code blob-code-inner js-file-line\">\t\tlogoutUrl<span class=\"pl-k\">:</span> <span class=\"pl-k\">&lt;</span>provide the logout url <span class=\"pl-k\">:</span> https<span class=\"pl-k\">:</span><span class=\"pl-c\"><span class=\"pl-c\">//</span>localhost:9443/samlsso&gt;,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-strategy-js-LC11\" class=\"blob-code blob-code-inner js-file-line\">    \t\tprivateCert<span class=\"pl-k\">:</span> <span class=\"pl-smi\">fs</span>.<span class=\"pl-en\">readFileSync</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>./security/private-key.pem<span class=\"pl-pds\">&#39;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>utf-8<span class=\"pl-pds\">&#39;</span></span>),</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-strategy-js-LC12\" class=\"blob-code blob-code-inner js-file-line\">\t\tcert<span class=\"pl-k\">:</span> <span class=\"pl-smi\">fs</span>.<span class=\"pl-en\">readFileSync</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>./security/wso2carbon.pem<span class=\"pl-pds\">&#39;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>utf8<span class=\"pl-pds\">&#39;</span></span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-strategy-js-LC13\" class=\"blob-code blob-code-inner js-file-line\">\t},</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-strategy-js-LC14\" class=\"blob-code blob-code-inner js-file-line\">\t(<span class=\"pl-smi\">profile</span>, <span class=\"pl-smi\">done</span>) <span class=\"pl-k\">=&gt;</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-strategy-js-LC15\" class=\"blob-code blob-code-inner js-file-line\">\t\t<span class=\"pl-c\"><span class=\"pl-c\">//</span> your body implementation on success</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-strategy-js-LC16\" class=\"blob-code blob-code-inner js-file-line\">\t}</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-strategy-js-LC17\" class=\"blob-code blob-code-inner js-file-line\">);</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-strategy-js-LC18\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-strategy-js-LC19\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> register the strategy with passport</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-strategy-js-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-strategy-js-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">passport</span>.<span class=\"pl-en\">use</span>(strategy);</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/athiththan11/d5c4fdcd7adad232b6f7f018fbc76efd/raw/388921bbf390824c3d3fb776c0452b25db6eedf6/strategy.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/athiththan11/d5c4fdcd7adad232b6f7f018fbc76efd#file-strategy-js\">strategy.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<h2>Run &#x26; Test</h2>\n<h3>Run</h3>\n<p>Run the express application by executing the given command from the root folder</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npm start</code></pre></div>\n<p>Also, start your WSO2 Identity Server instance using the following command from your <code class=\"language-text\">&lt;IS_HOME&gt;/bin</code> directory</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">sh wso2server.sh</code></pre></div>\n<h3>Test</h3>\n<p>Open your favorite browser and navigate to <code class=\"language-text\">http://localhost:3000/app</code>. The browser will redirect to the WSO2 Identity Serverâ€™s sign-in page to enter the login credentials.</p>\n<blockquote>\n<p>For this demo, you can use <code class=\"language-text\">admin</code> as both the username and password to sign in with the WSO2 Identity Server</p>\n</blockquote>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 51.78571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA50lEQVQoz43OTU4CMRQH8N5HktnOzPGIhAMYMJEDeAAyHAGiK3fqAokuWmzCdHT6+aYtVkjIMFOiv7y+Td//tWjf4g+dg79/orNHMlnh2xWeLPHdA6nBnwZOkFJShdMipKRltfsWJVdlLY8lZAQyPQBgjLbWth8BE3EpLHnNhPhqQIERzoIB+E9YQ2ONpLx84WxdVe+6fnMNA2j+DmutvfdFMR+NhtPpTajx+HpRzJ1z4aob1j3hg5hsn1/Xmw/8SSnGmDF23NuBXMy+JzqGtudIB/5FLkBZluV5nqZp6EmSDA6uegYxP4HFCKTMO9+bAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"WSO2 Identity Server: Login Page for SAML\"\n        title=\"\"\n        src=\"/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-fb8a0.png\"\n        srcset=\"/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-1a291.png 148w,\n/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-2bc4a.png 295w,\n/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-fb8a0.png 590w,\n/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-526de.png 885w,\n/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-fa2eb.png 1180w,\n/static/idp_login_page-7081a0e2a34cb5524e2d42ed074fc5f0-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>After presenting the login credentials, the Identity Server will prompt a user consent page to either approve or deny requested claims. Choose <em>Select All</em> and <em>Approve</em>.</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 51.78571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/klEQVQoz43RzUrEMBAH8LyPC722fU0RL14EwZtvoYKg4GFBLyLdzdY22s/sJjOTpKatyHYriz/+SQ7JMCFh3RRZd7P8vHzMrp/FxUN6dsfP7/np7frqKTPWHRxmSu2UH7+ULusiz99zkWRileaJjyh42VR+bzfFYAoRtca2qRAUoR5jDXWdg5lJsQYwhKKBF17wFlY1rGvtk1Sq1USIx4rHzqBRNlspldxqCWYMkMHjnT0iamXdlBtSX6DqzsohrTP+WrPOeo9/OWfoNRHLN25Nf5joJ/2FZpidca7/kn6xzk5yiH3sSQebQfoPLIqiOI7DMPRzEASLwcnM4i/f91gNcd/bBN8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"WSO2 Identity Server: User Consent Page\"\n        title=\"\"\n        src=\"/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-fb8a0.png\"\n        srcset=\"/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-1a291.png 148w,\n/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-2bc4a.png 295w,\n/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-fb8a0.png 590w,\n/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-526de.png 885w,\n/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-fa2eb.png 1180w,\n/static/idp_consent_page-a63a2fbdfa5dea4a012d59f621c4f52f-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>After successful authentication, the browser will redirect and displays you the logged-in page of our express application.</p>\n<p>\n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 23.357142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAUElEQVQY06WL0QqAIAxF/f8PTWisFQlepWlOCnqpoA6Xu7FxHACZlzUEpByRItD7SDvepX1dPRkNYmYbRIP3k0h9xORSbNs6qnrtd/kzv+Qdp8QnWLH1Ei8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Successful log-in\"\n        title=\"\"\n        src=\"/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-fb8a0.png\"\n        srcset=\"/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-1a291.png 148w,\n/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-2bc4a.png 295w,\n/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-fb8a0.png 590w,\n/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-526de.png 885w,\n/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-fa2eb.png 1180w,\n/static/sp_logged_page-e2ea095155260cc50ee81c27357968eb-4f5a6.png 1400w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  </p>\n<p>Navigate to <code class=\"language-text\">http://localhost:3000/app/logout</code> to log-out from the SAML SSO session.</p>\n<h2>GitHub</h2>\n<br>\n<a class=\"ul-disabled\" href=\"https://github.com/athiththan11/Passport-SAML-WSO2\">\n    <div class=\"card\">\n        <div class=\"card-horizontal\">\n            <div class=\"card-body py-4 px-5\">\n                <h4 class=\"card-title mt-4\">Passport SAML WSO2</h4>\n                <p>A sample express application with Passport-SAML for WSO2 SAML2 SSO</p>\n                <footer class=\"blockquote-footer\">\n                    <small class=\"text-muted\">\n                        athiththan11\n                    </small>\n                </footer>\n            </div>\n            <div class=\"img-square-wrapper\">\n                <img class=\"rounded mb-0\" width=\"220.172\" src=\"https://avatars3.githubusercontent.com/u/29927177?s=460&amp;v=4\" alt>\n            </div>\n        </div>\n    </div>\n</a>\n<hr class=\"three--dots\"/>","frontmatter":{"title":"SAML SSO with Passport","intro":"WSO2 Identity Server: SAML SSO & Passport SAML","tags":["wso2","wso2-identity-server","saml-sso","passport-saml"],"author":"Athiththan"}}},"pageContext":{"slug":"/SAML-SSO-with-Passport/","node_id":"51f5b88a-da9c-588c-95f2-b619c85c5533","nodePath":"/SAML-SSO-with-Passport/","nodeType":"sheet","title":"SAML SSO with Passport","category":"WSO2","weight":-1,"updated":"2019-07-20T00:00:00.000Z","author":"Athiththan","short":"An Express & Passport Implementation for SAML SSO","tags":["wso2","wso2-identity-server","saml-sso","passport-saml"]}}